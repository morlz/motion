!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("dom-css"),require("popmotion")):"function"==typeof define&&define.amd?define(["dom-css","popmotion"],n):t["@morlz/motion"]=n(t.css,t.popmotion)}(this,function(t,n){t=t&&t.hasOwnProperty("default")?t.default:t;var o=function(){this.motions={},this.rounds={}};o.prototype.get=function(t){if(!this.motions[t])return null;var n=this.motions[t].getBoundingClientRect();return{width:n.width/window.innerWidth*100,height:n.height/window.innerHeight*100,x:n.x,y:n.y,cx:-window.innerWidth/2+ +n.x+ +n.width/2,cy:-window.innerHeight/2+ +n.y+ +n.height/2,r:this.rounds[t]||0,progress:0}},o.prototype.set=function(t,n){this.motions[t]=n},o.prototype.setRound=function(t,n){void 0===n&&(n=1),this.rounds[t]=n};var e=new o,i={bind:function(t,n,o){t.addEventListener("click",function(o){return e.set(n.value,t)}),n.modifiers.round&&e.setRound(n.value)}},r={wrapper:function(t){return{maxWidth:t.width+"vw",maxHeight:t.height+"vh",transform:"translate("+t.x+"px, "+t.y+"px)",transition:"none",opacity:1}},content:function(t){return{borderRadius:100*t.r+"%",transition:"none",overflow:1==t.progress?"auto":"hidden",minWidth:0}},firstChild:function(t){return{width:t.toWidth+"vw",height:t.toHeight+"vh",transition:"all .375s ease-in-out"}},toolbar:function(t){return{opacity:t.progress,transform:"translateY("+(30*t.progress-30)+"%)"}}},u=function(t){return{wrapper:t,content:t.querySelector(".modal-content"),firstChild:t.querySelector(".modal-content > *"),toolbar:t.querySelector(".modal-toolbar")}};function s(n,o){var e=u(n),i=e.wrapper,s=e.content,c=e.toolbar;i&&t(i,r.wrapper(o)),s&&t(s,r.content(o)),c&&t(c,r.toolbar(o))}var c=function(t,n){return void 0===n&&(n=30),new Promise(function(o){setTimeout(function(){return t()?o():c(t,n)},n)})};var d={width:100,height:100,cx:0,cy:0,x:0,y:0,r:0,progress:1},h={duration:375,easing:n.easing.cubicBezier(.4,0,.2,1)},a={MotionFrom:i,MotionTo:{bind:function(o,i,r){return new Promise(function(u,a){var f,m,p,l;return f=r.context,null===(m=e.get(i.value))||f.__motionInjected?u():(p=t.get(o,"overflow"),t.set(o,{opacity:0,overflow:"hidden"}),(l=f,new Promise(function(t){return c(function(){return l._isMounted}).then(t)})).then(function(r){try{return f.$once("motion:show",function(){n.tween(Object.assign({},{from:Object.assign({},m,{toWidth:d.width,toHeight:d.height}),to:Object.assign({},d,{toWidth:d.width,toHeight:d.height})},h)).start({update:function(t){s(o,t),f.$motion=t,f.$forceUpdate()},complete:function(n){t.set(o,"overflow",p),f.$emit("motion:showed")}})}),f.$once("motion:hide",function(){var r=e.get(i.value);null!==r&&(t.set(o,"overflow","hidden"),n.tween(Object.assign({},{from:Object.assign({},d,{toWidth:r.width,toHeight:r.height}),to:Object.assign({},r,{toWidth:r.width,toHeight:r.height})},h)).start({update:function(t){s(o,t),f.$motion=t,f.$forceUpdate()},complete:function(n){t.set(o,"overflow",p),f.$emit("motion:hided")}}))}),(c=f,new Promise(function(t,n){return c.__motionInjected=!0,c.$emit("motion:show"),t()})).then(function(t){try{return u()}catch(t){return a(t)}},a)}catch(t){return a(t)}var c},a))})}}};return{install:function(t,n){var o=Object.assign({},a);t.prototype.$motion={},Object.keys(o).map(function(n){return t.directive(n,o[n])}),t.mixin({beforeRouteLeave:function(t,n,o){this.__motionInjected?(this.$emit("motion:hide"),setTimeout(function(){return o()},400)):o()}})}}});
//# sourceMappingURL=motion.min.umd.js.map
